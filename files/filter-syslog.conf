filter {
  if [type] == "system-logs-beat" {
    grok {
      match => { "message" => "%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}" }
    }
    syslog_pri { }
    date {
      match => [ "syslog_timestamp", "MMM  d HH:mm:ss", "MMM dd HH:mm:ss" ]
    }
    mutate {
      add_tag => [ "syslog" ]
      remove_tag => [ "beats_input_codec_plain_applied" ]
      remove_field => [ "offset", "count", "input_type", "beat", "syslog_timestamp", "host" ]
      rename => { "syslog_hostname" => "hostname" }
      rename => { "syslog_program" => "program" }
      rename => { "syslog_pid" => "pid" }
      rename => { "syslog_message" => "message" }
      rename => { "syslog_severity_code" => "severity_code" }
      rename => { "syslog_facility_code" => "facility_code" }
      rename => { "syslog_facility" => "facility" }
      rename => { "syslog_severity" => "severity" }
    }
    if !("_grokparsefailure" in [tags]) {
      mutate {
        remove_field => [ "@version" ]
      }
    }
  }
}
