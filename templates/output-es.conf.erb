output {
  if "_grokparsefailure" in [tags] or "_rubyexception" in [tags] {
    file { path => "/var/log/logstash/failed_events-%{+YYYY-MM-dd}" }
  }
  else {
    elasticsearch {
      hosts => ["localhost:9200"]
      sniffing => true
      manage_template => true
    }
    <% if scope.lookupvar('cirrus_logstash::cross_site_enabled') == true %>
    elasticsearch {
      hosts => <%= scope.lookupvar('cirrus_logstash::cross_site_elasticsearch') %>
      sniffing => true
      manage_template => true
    }<% end %>
    <% if scope.lookupvar('cirrus_logstash::output_stdout') == true %>
    stdout { codec => rubydebug }<% end %>
  }
}
